# åŸºäºMCPè‡ªåŠ¨åŒ–ä¸­å¿ƒåŒ–ç®¡ç†skills

## ğŸ“š ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å®‰è£…éƒ¨ç½²](#å®‰è£…éƒ¨ç½²)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [åŠŸèƒ½è¯¦è§£](#åŠŸèƒ½è¯¦è§£)
- [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
- [APIæ¥å£](#apiæ¥å£)
- [å·¥ä½œæµç¨‹](#å·¥ä½œæµç¨‹)
- [ä¾èµ–ç®¡ç†](#ä¾èµ–ç®¡ç†)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®èƒŒæ™¯

MCP Skill Manager æ˜¯ä¸€ä¸ªåŸºäº **Model Context Protocol (MCP)** çš„æŠ€èƒ½ç®¡ç†æœåŠ¡å™¨ï¼Œæ—¨åœ¨ä¸º Claude Code å’Œå…¶ä»– AI å·¥å…·æä¾›ç»Ÿä¸€çš„æŠ€èƒ½åŒ…ç®¡ç†èƒ½åŠ›ï¼Œä¸ºè§£å†³skillç®¡ç†ç´Šä¹±åœºæ™¯è€Œè®¾è®¡ã€‚

### 1.2 æ ¸å¿ƒç›®æ ‡

- **ç»Ÿä¸€ç®¡ç†**ï¼šé›†ä¸­ç®¡ç†æ‰€æœ‰ AI æŠ€èƒ½åŒ…ï¼Œä¾¿äºç‰ˆæœ¬æ§åˆ¶å’Œåˆ†å‘
- **ä¾èµ–è§£æ**ï¼šè‡ªåŠ¨åˆ†æå’Œå¤„ç†æŠ€èƒ½ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ˆç±»ä¼¼ Maven/npmï¼‰
- **å¿«é€Ÿåˆ†å‘**ï¼šé€šè¿‡ HTTP æœåŠ¡å¿«é€Ÿä¸‹è½½æŠ€èƒ½åŒ…åŠå…¶ä¾èµ–
- **è‡ªåŠ¨åŒæ­¥**ï¼šå®šæœŸåŒæ­¥ Git ä»“åº“ï¼Œä¿æŒæŠ€èƒ½åŒ…æœ€æ–°çŠ¶æ€
- **æ ‡å‡†åè®®**ï¼šåŸºäº MCP åè®®ï¼Œå¯ä¸ä»»ä½•æ”¯æŒ MCP çš„å·¥å…·é›†æˆ

### 1.3 ä¸»è¦ç‰¹æ€§

- âœ… æŠ€èƒ½åˆ—è¡¨æŸ¥è¯¢ï¼ˆæ”¯æŒå…³é”®è¯æœç´¢ï¼‰
- âœ… æŠ€èƒ½è¯¦æƒ…æŸ¥çœ‹ï¼ˆåŒ…å«æ–‡ä»¶ç»Ÿè®¡ã€ä¾èµ–æ ‘ï¼‰
- âœ… æ™ºèƒ½ä¾èµ–ç®¡ç†ï¼ˆè‡ªåŠ¨æ”¶é›†ä¼ é€’ä¾èµ–ï¼‰
- âœ… ä¸€é”®ä¸‹è½½å®‰è£…ï¼ˆæ”¯æŒå•ä¸ªæˆ–å…¨éƒ¨æŠ€èƒ½ï¼‰
- âœ… ç¼“å­˜æœºåˆ¶ï¼ˆåŠ é€Ÿé‡å¤ä¸‹è½½ï¼‰
- âœ… å®šæ—¶åŒæ­¥ï¼ˆæ¯å°æ—¶è‡ªåŠ¨æ›´æ–°ä»“åº“ï¼‰
- âœ… å¾ªç¯ä¾èµ–æ£€æµ‹

---

## æ¶æ„è®¾è®¡

### 2.1 ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Claude Code / Codex AI Tools           â”‚
â”‚                         (MCP Client)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ MCPï½œHTTP Protocol
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MCP Skill Manager Server                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  FastMCP       â”‚           â”‚   FastAPI       â”‚           â”‚
â”‚  â”‚  (MCP Tools)   â”‚           â”‚   (HTTP Server) â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚         â”‚                              â”‚                    â”‚
â”‚         â†“                              â†“                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚         Skill Management Core              â”‚             â”‚
â”‚  â”‚  - list_skills()                           â”‚             â”‚
â”‚  â”‚  - get_skill_info()                        â”‚             â”‚
â”‚  â”‚  - download_skill()                        â”‚             â”‚
â”‚  â”‚  - clear_cache()                           â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                                                   â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚      Dependency Analysis Engine            â”‚             â”‚
â”‚  â”‚  - analyze_skill_dependencies()            â”‚             â”‚
â”‚  â”‚  - build_dependency_tree()                 â”‚             â”‚
â”‚  â”‚  - collect_all_dependencies()              â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                                                   â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚         Background Scheduler               â”‚             â”‚
â”‚  â”‚  - Git sync (hourly)                       â”‚             â”‚
â”‚  â”‚  - Dependency update                       â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ Git Operations
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Git Repository (Skills)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | æŠ€æœ¯æ ˆ | èŒè´£ |
|------|--------|------|
| **MCP Server** | FastMCP | æä¾› MCP åè®®çš„å·¥å…·æ¥å£ |
| **HTTP Server** | FastAPI + Uvicorn | æä¾›æ–‡ä»¶ä¸‹è½½æœåŠ¡ |
| **Dependency Engine** | Python | åˆ†æå’Œè§£ææŠ€èƒ½ä¾èµ–å…³ç³» |
| **Scheduler** | APScheduler | å®šæ—¶ä»»åŠ¡ï¼ˆGit åŒæ­¥ï¼‰ |
| **Cache Manager** | File System | ç®¡ç†å‹ç¼©åŒ…ç¼“å­˜ |

### 2.3 æ•°æ®æµ

```
User Request â†’ MCP Client â†’ MCP Server â†’ Skill Analysis â†’ Git Repo
                                â†“
                          Dependency Tree
                                â†“
                          Package Skills
                                â†“
                         Cache (.tar.gz)
                                â†“
                        HTTP Download URL
                                â†“
                          User Downloads
```

---

## ç¯å¢ƒè¦æ±‚

### 3.1 ç³»ç»Ÿè¦æ±‚

- Python 3.10+
- Git 2.0+
- æ“ä½œç³»ç»Ÿï¼šmacOS / Linux / Windows

### 3.2 ä¾èµ–åŒ…

```txt
fastapi       # Web æ¡†æ¶
uvicorn       # ASGI æœåŠ¡å™¨
fastmcp       # MCP åè®®å®ç°
apscheduler   # å®šæ—¶ä»»åŠ¡
```

---

## å®‰è£…éƒ¨ç½²
```markdown
æœ¬æ–‡æ¡£ä½¿ç”¨å®Œæ•´çš„æºç éƒ¨ç½²ï¼Œå¯ä»¥ç»Ÿä¸€éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œæœ¬åœ°AIå®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨mcpæœåŠ¡å³å¯ï¼Œ è¿˜å¯ä½¿ç”¨æ‰“åŒ…å¥½çš„mcp_serverç¨‹åºåŒ…ç›´æ¥è¿è¡Œï¼Œæ— éœ€ä¾èµ–å„ç§ç¯å¢ƒ
```



### 4.1 å…‹éš†é¡¹ç›®

å‡†å¤‡é¡¹ç›®ç¯å¢ƒ

### 4.2 åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
python3 -m venv .venv
source .venv/bin/activate  # macOS/Linux
# .venv\Scripts\activate    # Windows
```

### 4.3 å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 4.4 é…ç½® Git SSH Key

ç¡®ä¿å·²é…ç½® Git SSH Keyï¼Œèƒ½å¤Ÿè®¿é—®æŠ€èƒ½ä»“åº“ï¼š

```bash
ssh -T git@github..com
```

### 4.5 å¯åŠ¨æœåŠ¡å™¨

```bash
python mcp_server.py
```

å¯åŠ¨åï¼ŒæœåŠ¡å™¨å°†ï¼š
1. è‡ªåŠ¨åŒæ­¥ skills ä»“åº“
2. åŠ è½½æ‰€æœ‰æŠ€èƒ½ä¿¡æ¯
3. åˆ†æä¾èµ–å…³ç³»
4. å¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å°æ—¶åŒæ­¥ï¼‰

---

## é…ç½®è¯´æ˜

### 5.1 æ ¸å¿ƒé…ç½®

åœ¨ `mcp_server.py` ä¸­ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š

```python
# Git ä»“åº“åœ°å€
REPO_URL = "git@gihub.com:xxx/skills.git"

# æœ¬åœ°å­˜å‚¨ç›®å½•
LOCAL_DIR = os.path.join(BASE_DIR, "skills")

# ç¼“å­˜ç›®å½•
CACHE_DIR = os.path.join(LOCAL_DIR, ".skill-cache")

# HTTP æœåŠ¡åœ°å€
SKILL_FILE_BASE_URL = "http://localhost:8002"

# æœåŠ¡ç«¯å£
PORT = 8002
```

### 5.2 mcp client é…ç½®
#### 5.2.1 claude code
```bash
claude mcp add --transport http skill-manager http://localhost:8002/ai/mcp
```
é‡å¯claude code

#### 5.2.2 codex
```bash
cd ~/.codex
vi config.toml
```
åœ¨é…ç½®æ–‡ä»¶æ–°å¢ï¼š
```toml
[mcp_servers.skill-manager]
type="http"
url="http://localhost:8002/ai/mcp"
```
é‡å¯codex cli

---

## åŠŸèƒ½è¯¦è§£

### 6.1 æŠ€èƒ½åˆ—è¡¨æŸ¥è¯¢

**åŠŸèƒ½**ï¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨æŠ€èƒ½ï¼Œæ”¯æŒå…³é”®è¯æœç´¢

**MCP Tool**ï¼š`list_skills(keyword: str = "")`

**ç¤ºä¾‹**ï¼š

```python
# åˆ—å‡ºæ‰€æœ‰æŠ€èƒ½
result = list_skills()

# æœç´¢åŒ…å« "xx" çš„æŠ€èƒ½
result = list_skills(keyword="xx")
```

**è¿”å›ç»“æ„**ï¼š

```json
{
  "status": "success",
  "count": 25,
  "data": {
    "xx-infra-stack": {
      "id": "infra-stack",
      "name": "Infrastructure Stack",
      "description": "åŸºç¡€è®¾æ–½æŠ€æœ¯æ ˆè§„èŒƒ",
      "dependencies": ["writing-plans", "executing-plans"]
    },
    ...
  }
}
```


### 6.2 æŠ€èƒ½è¯¦æƒ…æŸ¥çœ‹

**åŠŸèƒ½**ï¼šæŸ¥çœ‹å•ä¸ªæŠ€èƒ½çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç»Ÿè®¡ã€ä¾èµ–æ ‘

**MCP Tool**ï¼š`get_skill_info(skill_id: str)`

**ç¤ºä¾‹**ï¼š

```python
result = get_skill_info(skill_id="xx-infra-stack")
```

**è¿”å›ç»“æ„**ï¼š

```json
{
  "status": "success",
  "data": {
    "id": "infra-stack",
    "name": "Infrastructure Stack",
    "description": "åŸºç¡€è®¾æ–½æŠ€æœ¯æ ˆè§„èŒƒ",
    "file_count": 8,
    "total_size_kb": 124.5,
    "direct_dependencies": ["writing-plans", "executing-plans"],
    "direct_dependencies_count": 2,
    "dependency_tree": {
      "skill_id": "infra-stack",
      "exists": true,
      "dependencies": [...]
    },
    "dependency_tree_text": "infra-stack\nâ”œâ”€â”€ writing-plans\nâ””â”€â”€ executing-plans"
  }
}
```

### 6.3 æŠ€èƒ½ä¸‹è½½

**åŠŸèƒ½**ï¼šä¸‹è½½æŠ€èƒ½åŒ…åŠå…¶æ‰€æœ‰ä¾èµ–ï¼ˆç±»ä¼¼ Mavenï¼‰

**MCP Tool**ï¼š`download_skill(skill_id: str, download_all: bool, install_dir: str)`

**ç¤ºä¾‹**ï¼š

```python
# ä¸‹è½½å•ä¸ªæŠ€èƒ½ï¼ˆå«ä¾èµ–ï¼‰
result = download_skill(
    skill_id="infra-stack",
    install_dir="~/.claude/skills"
)

# ä¸‹è½½æ‰€æœ‰æŠ€èƒ½
result = download_skill(
    download_all=True,
    install_dir="~/.claude/skills"
)
```

**è¿”å›ç»“æ„**ï¼š

```json
{
  "status": "success",
  "skill_id": "infra-stack",
  "dependencies": ["writing-plans", "executing-plans"],
  "total_skills": 3,
  "download_url": "http://localhost:8002/download/infra-stack-with-deps",
  "size_kb": 256.8,
  "install_dir": "~/.claude/skills",
  "instruction": "mkdir -p ~/.claude/skills && curl -o ~/.claude/skills/infra-stack.tar.gz http://localhost:8002/download/infra-stack-with-deps && tar -xkzf ~/.claude/skills/infra-stack.tar.gz -C ~/.claude/skills/ && rm ~/.claude/skills/infra-stack.tar.gz"
}
```

**æ‰§è¡Œä¸‹è½½**ï¼ˆæ ¹æ®è¿”å›çš„ `instruction` å­—æ®µï¼‰ï¼š

```bash
mkdir -p ~/.claude/skills && \
  curl -o ~/.claude/skills/infra-stack.tar.gz http://localhost:8002/download/infra-stack-with-deps && \
  tar -xkzf ~/.claude/skills/infra-stack.tar.gz -C ~/.claude/skills/ && \
  rm ~/.claude/skills/infra-stack.tar.gz
```

### 6.4 ç¼“å­˜æ¸…ç†

**åŠŸèƒ½**ï¼šæ¸…ç†å‹ç¼©åŒ…ç¼“å­˜ï¼Œå¼ºåˆ¶é‡æ–°ç”Ÿæˆ

**MCP Tool**ï¼š`clear_skill_cache()`

**ç¤ºä¾‹**ï¼š

```python
result = clear_skill_cache()
```

---

## ä½¿ç”¨æŒ‡å—

### 7.1 åœ¨ Claude Code ä¸­ä½¿ç”¨

#### Step 1: å¯åŠ¨ MCP Server

```bash
python mcp_server.py
```

#### Step 2: æŸ¥è¯¢å¯ç”¨æŠ€èƒ½

åœ¨ Claude Code ä¸­è¾“å…¥ï¼š

```
è¯·åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ skills
```

Claude ä¼šè°ƒç”¨ `list_skills()` å¹¶å±•ç¤ºç»“æœè¡¨æ ¼ã€‚

#### Step 3: æŸ¥çœ‹æŠ€èƒ½è¯¦æƒ…

```
è¯·æŸ¥çœ‹ xx-infra-stack è¿™ä¸ª skill çš„è¯¦ç»†ä¿¡æ¯
```

Claude ä¼šè°ƒç”¨ `get_skill_info()` å¹¶å±•ç¤ºï¼š
- æ–‡ä»¶æ•°é‡å’Œå¤§å°
- ç›´æ¥ä¾èµ–åˆ—è¡¨
- å®Œæ•´ä¾èµ–æ ‘

#### Step 4: ä¸‹è½½å®‰è£…æŠ€èƒ½

```
è¯·ä¸‹è½½ xx-infra-stack æŠ€èƒ½åˆ° ~/.claude/skills
```

Claude ä¼šï¼š
1. è°ƒç”¨ `download_skill()` è·å–ä¸‹è½½æŒ‡ä»¤
2. æ‰§è¡Œ curl + tar å‘½ä»¤å®Œæˆä¸‹è½½å’Œè§£å‹
3. ç¡®è®¤å®‰è£…æˆåŠŸ

### 7.2 é€šè¿‡ HTTP API ç›´æ¥ä¸‹è½½

#### ä¸‹è½½å•ä¸ªæŠ€èƒ½ï¼ˆå«ä¾èµ–ï¼‰

```bash
curl -o skill.tar.gz http://localhost:8002/download/infra-stack-with-deps
tar -xkzf skill.tar.gz -C ~/.claude/skills/
```

#### ä¸‹è½½æ‰€æœ‰æŠ€èƒ½

```bash
curl -o all-skills.tar.gz http://localhost:8002/download/all
tar -xkzf all-skills.tar.gz -C ~/.claude/skills/
```

---

## API æ¥å£

### 8.1 MCP Tools

| Tool Name | Parameters | Description |
|-----------|------------|-------------|
| `list_skills` | `keyword: str` | åˆ—å‡ºæ‰€æœ‰æŠ€èƒ½ï¼Œæ”¯æŒæœç´¢ |
| `get_skill_info` | `skill_id: str` | è·å–æŠ€èƒ½è¯¦æƒ… |
| `download_skill` | `skill_id: str`<br>`download_all: bool`<br>`install_dir: str` | è·å–ä¸‹è½½ä¿¡æ¯ |
| `clear_skill_cache` | æ—  | æ¸…ç†ç¼“å­˜ |

### 8.2 HTTP Endpoints

| Method | Path | Description |
|--------|------|-------------|
| GET | `/download/{skill_id}` | ä¸‹è½½å•ä¸ªæŠ€èƒ½ï¼ˆä¸å«ä¾èµ–ï¼‰ |
| GET | `/download/{skill_id}-with-deps` | ä¸‹è½½æŠ€èƒ½åŠæ‰€æœ‰ä¾èµ– |
| GET | `/download/all` | ä¸‹è½½æ‰€æœ‰æŠ€èƒ½ |
| * | `/ai/mcp` | MCP åè®®ç«¯ç‚¹ |

---

## å·¥ä½œæµç¨‹

### 9.1 å¯åŠ¨æµç¨‹

```mermaid
graph TD
    A[å¯åŠ¨ MCP Server] --> B[æ­¥éª¤1: åŒæ­¥ Git ä»“åº“]
    B --> C{ä»“åº“æ˜¯å¦å­˜åœ¨?}
    C -->|å¦| D[git clone]
    C -->|æ˜¯| E[git pull]
    D --> F[æ­¥éª¤2: æ‰«ææŠ€èƒ½ç›®å½•]
    E --> F
    F --> G[è¯»å– skill.md å…ƒæ•°æ®]
    G --> H[æ­¥éª¤3: åˆ†æä¾èµ–å…³ç³»]
    H --> I[è§£æ YAML front matter]
    H --> J[æ‰«æ skill æ ‡ç­¾]
    I --> K[æ„å»ºä¾èµ–å›¾]
    J --> K
    K --> L[å¯åŠ¨å®šæ—¶ä»»åŠ¡]
    L --> M[å¯åŠ¨ HTTP æœåŠ¡å™¨]
    M --> N[æœåŠ¡å°±ç»ª]
```

### 9.2 æŸ¥è¯¢æŠ€èƒ½æµç¨‹

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·/Claude
    participant MCP as MCP Server
    participant Cache as å†…å­˜ç¼“å­˜
    participant FS as æ–‡ä»¶ç³»ç»Ÿ

    User->>MCP: list_skills(keyword)
    MCP->>Cache: è¯»å– skills å­—å…¸
    Cache-->>MCP: è¿”å›æŠ€èƒ½åˆ—è¡¨
    MCP->>MCP: è¿‡æ»¤å…³é”®è¯
    MCP-->>User: è¿”å›ç»“æœè¡¨æ ¼
```

### 9.3 ä¸‹è½½æŠ€èƒ½æµç¨‹

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·/Claude
    participant MCP as MCP Server
    participant Dep as ä¾èµ–å¼•æ“
    participant Cache as ç¼“å­˜ç³»ç»Ÿ
    participant HTTP as HTTP Server

    User->>MCP: download_skill(skill_id)
    MCP->>Dep: collect_all_dependencies()
    Dep->>Dep: é€’å½’åˆ†æä¾èµ–æ ‘
    Dep-->>MCP: è¿”å›ä¾èµ–åˆ—è¡¨
    MCP->>MCP: ç”Ÿæˆä¸‹è½½ URL
    MCP-->>User: è¿”å› instruction å‘½ä»¤
    User->>HTTP: curl download URL
    HTTP->>Cache: æ£€æŸ¥ç¼“å­˜
    Cache-->HTTP: ç¼“å­˜æœªå‘½ä¸­
    HTTP->>HTTP: æ‰“åŒ… tar.gz
    HTTP->>Cache: ä¿å­˜åˆ°ç¼“å­˜
    HTTP-->>User: è¿”å›å‹ç¼©åŒ…
    User->>User: tar è§£å‹åˆ°ç›®æ ‡ç›®å½•
```

### 9.4 ä¾èµ–è§£ææµç¨‹

```mermaid
graph TD
    A[è¯»å– skill.md] --> B{YAML Front Matter}
    B -->|å­˜åœ¨| C[è§£æ dependencies å­—æ®µ]
    B -->|ä¸å­˜åœ¨| D[ç»§ç»­]
    C --> E[æå–ä¾èµ–åˆ—è¡¨]
    A --> F[æ‰«ææ–‡æ¡£å†…å®¹]
    F --> G[åŒ¹é… skill æ ‡ç­¾]
    G --> H[æå–æ ‡ç­¾å†…å®¹]
    E --> I[åˆå¹¶å»é‡]
    H --> I
    I --> J[é€’å½’åˆ†æå­ä¾èµ–]
    J --> K[æ„å»ºä¾èµ–æ ‘]
    K --> L[æ£€æµ‹å¾ªç¯ä¾èµ–]
```

---

## ä¾èµ–ç®¡ç†

### 10.1 ä¾èµ–å£°æ˜æ–¹å¼

#### æ–¹å¼1ï¼šYAML Front Matter

åœ¨ `skill.md` æ–‡ä»¶å¤´éƒ¨å£°æ˜ï¼š

```markdown
---
name: devops-flow
description: DevOps æµç¨‹è§„èŒƒ
dependencies: ['writing-plans', 'executing-plans']
---

# Skill å†…å®¹...
```

#### æ–¹å¼2ï¼šSkill æ ‡ç­¾

åœ¨æ–‡æ¡£å†…å®¹ä¸­å¼•ç”¨ï¼š

```markdown
æœ¬æŠ€èƒ½ä¾èµ– <skill>writing-plans</skill> å’Œ <skill>executing-plans</skill>ã€‚
```

### 10.2 ä¾èµ–æ ‘ç¤ºä¾‹

```
devops-flow
â”œâ”€â”€ writing-plans
â”‚   â””â”€â”€ brainstorming
â””â”€â”€ executing-plans
    â”œâ”€â”€ infra-stack
    â”‚   â””â”€â”€ java-code-style
    â””â”€â”€ commit-and-deploy
```

### 10.3 å¾ªç¯ä¾èµ–æ£€æµ‹

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æ ‡è®°å¾ªç¯ä¾èµ–ï¼š

```
skillA
â”œâ”€â”€ skillB
â”‚   â””â”€â”€ skillC
â”‚       â””â”€â”€ skillA [å¾ªç¯ä¾èµ–]
```

### 10.4 ä¼ é€’ä¾èµ–æ”¶é›†

ä¸‹è½½ `devops-flow` æ—¶ï¼Œä¼šè‡ªåŠ¨ä¸‹è½½ï¼š
- `devops-flow` (ä¸»æŠ€èƒ½)
- `writing-plans` (ç›´æ¥ä¾èµ–)
- `brainstorming` (ä¼ é€’ä¾èµ–)
- `executing-plans` (ç›´æ¥ä¾èµ–)
- `infra-stack` (ä¼ é€’ä¾èµ–)
- `java-code-style` (ä¼ é€’ä¾èµ–)
- `commit-and-deploy` (ä¼ é€’ä¾èµ–)

---

## å¸¸è§é—®é¢˜

### Q1: MCP Server æ— æ³•å¯åŠ¨

**é—®é¢˜**ï¼šå¯åŠ¨æ—¶æŠ¥é”™ `Git clone failed`

**è§£å†³**ï¼š
1. æ£€æŸ¥ SSH Key é…ç½®ï¼š`ssh -T git@github.com`
2. ç¡®è®¤ä»“åº“åœ°å€æ­£ç¡®ï¼šæ£€æŸ¥ `REPO_URL` é…ç½®
3. æ‰‹åŠ¨å…‹éš†æµ‹è¯•ï¼š`git clone git@github.com:xxx/skills.git`

### Q2: Claude Code æ— æ³•è¿æ¥ MCP Server

**é—®é¢˜**ï¼šClaude æç¤ºæ— æ³•ä½¿ç”¨ skill-manager å·¥å…·

**è§£å†³**ï¼š
1. ç¡®è®¤ MCP Server æ­£åœ¨è¿è¡Œï¼š`curl http://localhost:8002/ai/mcp`
2. æ£€æŸ¥ Claude é…ç½®æ–‡ä»¶ï¼š`~/.claude/mcp_server_config.json`
3. é‡å¯ Claude Code

### Q3: ä¸‹è½½çš„æŠ€èƒ½æ— æ³•ä½¿ç”¨

**é—®é¢˜**ï¼šæŠ€èƒ½å·²ä¸‹è½½åˆ° `~/.claude/skills`ï¼Œä½† Claude æ— æ³•è¯†åˆ«

**è§£å†³**ï¼š
1. æ£€æŸ¥è§£å‹è·¯å¾„ï¼š`ls ~/.claude/skills/`
2. ç¡®è®¤ç›®å½•ç»“æ„ï¼šæ¯ä¸ªæŠ€èƒ½åº”æœ‰ç‹¬ç«‹æ–‡ä»¶å¤¹
3. æ£€æŸ¥ skill.md æ–‡ä»¶æ˜¯å¦å­˜åœ¨
4. é‡å¯ Claude Code é‡æ–°åŠ è½½æŠ€èƒ½

### Q4: ä¾èµ–æœªè‡ªåŠ¨ä¸‹è½½

**é—®é¢˜**ï¼šåªä¸‹è½½äº†ä¸»æŠ€èƒ½ï¼Œä¾èµ–æœªä¸‹è½½

**è§£å†³**ï¼š
1. ç¡®è®¤ä½¿ç”¨çš„æ˜¯ `-with-deps` ç«¯ç‚¹
2. æ£€æŸ¥ä¾èµ–å£°æ˜æ˜¯å¦æ­£ç¡®ï¼ˆskill.md æ ¼å¼ï¼‰
3. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼Œç¡®è®¤ä¾èµ–åˆ†ææˆåŠŸ
4. æ¸…ç†ç¼“å­˜åé‡è¯•ï¼šè°ƒç”¨ `clear_skill_cache()`

### Q5: å¦‚ä½•æ›´æ–°æŠ€èƒ½åˆ°æœ€æ–°ç‰ˆæœ¬

**è§£å†³**ï¼š
1. ç­‰å¾…å®šæ—¶ä»»åŠ¡è‡ªåŠ¨åŒæ­¥ï¼ˆæ¯å°æ—¶ï¼‰
2. æˆ–é‡å¯ MCP Server è§¦å‘åŒæ­¥
3. æ¸…ç†ç¼“å­˜ï¼š`clear_skill_cache()`
4. é‡æ–°ä¸‹è½½æŠ€èƒ½

### Q6: å¦‚ä½•æ·»åŠ æ–°çš„æŠ€èƒ½

**æ­¥éª¤**ï¼š
1. åœ¨ Git ä»“åº“åˆ›å»ºæ–°æ–‡ä»¶å¤¹ï¼ˆæŠ€èƒ½ IDï¼‰
2. æ·»åŠ  `skill.md` æ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```markdown
---
name: my-new-skill
description: è¿™æ˜¯ä¸€ä¸ªæ–°æŠ€èƒ½
dependencies: []
---

# My New Skill

æŠ€èƒ½å†…å®¹...
```

3. æäº¤å¹¶æ¨é€åˆ°ä»“åº“
4. ç­‰å¾… MCP Server è‡ªåŠ¨åŒæ­¥ï¼Œæˆ–é‡å¯æœåŠ¡å™¨

---

## é™„å½•

### A1. skill.md æ¨¡æ¿

```markdown
---
name: skill-name
description: æŠ€èƒ½æè¿°ï¼ˆä¸€å¥è¯è¯´æ˜ç”¨é€”ï¼‰
dependencies: ['dependency1', 'dependency2']
---

# Skill Name

## æ¦‚è¿°

æŠ€èƒ½çš„è¯¦ç»†è¯´æ˜...

## ä½¿ç”¨åœºæ™¯

- åœºæ™¯1
- åœºæ™¯2ä¾èµ–<skill>skillA</skill>

## ç¤ºä¾‹

å…·ä½“ä½¿ç”¨ç¤ºä¾‹...
```

### A2. ç›®å½•ç»“æ„

```
skill-manager/
â”œâ”€â”€ mcp_server.py           # ä¸»æœåŠ¡å™¨è„šæœ¬
â”œâ”€â”€ requirements.txt        # Python ä¾èµ–
â”œâ”€â”€ README.md               # é¡¹ç›®è¯´æ˜
â””â”€â”€ skills/                 # æŠ€èƒ½ä»“åº“ï¼ˆGit cloneï¼‰
    â”œâ”€â”€ .git/
    â”œâ”€â”€ .skill-cache/       # å‹ç¼©åŒ…ç¼“å­˜
    â”œâ”€â”€ infra-stack/
    â”‚   â””â”€â”€ skill.md
    â”œâ”€â”€ writing-plans/
    â”‚   â””â”€â”€ skill.md
    â””â”€â”€ ...
```

### A3. æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ç¼“å­˜ç­–ç•¥**ï¼šå‹ç¼©åŒ…ç”Ÿæˆåä¼šç¼“å­˜ï¼Œæ— éœ€é‡å¤æ‰“åŒ…
2. **å¹¶å‘ä¸‹è½½**ï¼šHTTP Server æ”¯æŒå¹¶å‘è¯·æ±‚
3. **å¢é‡åŒæ­¥**ï¼šGit pull ä»…æ‹‰å–æ›´æ–°å†…å®¹
4. **ä¾èµ–å‰ªæ**ï¼šé¿å…é‡å¤æ‰“åŒ…ç›¸åŒä¾èµ–

### A4. å®‰å…¨å»ºè®®

1. **ä»…å†…ç½‘è®¿é—®**ï¼šå»ºè®®ä»…åœ¨å†…ç½‘ç¯å¢ƒéƒ¨ç½²
2. **SSH Key ä¿æŠ¤**ï¼šå¦¥å–„ä¿ç®¡ Git SSH Key
3. **ç«¯å£é˜²ç«å¢™**ï¼šé™åˆ¶ 8002 ç«¯å£è®¿é—®èŒƒå›´
4. **æ—¥å¿—å®¡è®¡**ï¼šå®šæœŸæ£€æŸ¥ä¸‹è½½æ—¥å¿—

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»ï¼š
- é‚®ç®±ï¼šlong2900645253@163.com

---
